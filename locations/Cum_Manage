# Cum_Manage
!{	Locations to be defined by 'spafinloc'
	0 = 'In your Vagina'
	1 = 'On your labia'
	2 = 'On your panties over your vagina'
	3 = 'In your anus'
	4 = 'On your butt'
	5 = 'On your panties over your butt'
	6 = 'On your clothes in your groin area'
	7 = 'On your clothes'
	8 = 'On your back'
	9 = 'On your legs'
	10 = 'On your arms'
	11 = 'On your face'
	12 = 'Inside your mouth'
	13 = 'On your hands'
	14 = 'On your stomach'
	15 = 'On your breasts'
	16 = 'In your hair'
	17 = 'In a condom in your vagina'}

!{ values of 'sexcontra'
	0 = 'No contraception used'
	1 = 'You lied about being on the pill'
	2 = 'You were on the pill'
	3 = 'You used a condom'
	4 = 'The condom broke'
	5 = 'The condom slipped off inside you'
	6 = 'The condom was sabotaged by someone else'
	7 = 'You sabotaged the condom'}


if $ARGS[0] = '':
	!{Sets the cum array temp to the current size of the cum array, to add a new entry to the end of file. Then checks to see if you are on the pill. If you are and there is no contraception used, it flags this as a "done with pill" act, which means a pregnancy will be a pill failure.}
	cumarr_idx = arrsize('$cumarrnam')
	if sexcontra = 0 and pillcon > 0: sexcontra = 2
	if vibratorIN = 1 and spafinloc = 0 and replace_vib = 0: vibratorIN = 0
	if analplugIN = 1 and spafinloc = 3 and replace_analplug = 0: analplugIN = 0
	!{It checks to see if this is flagged as a preejaculate emmission. All vaginal penetrations that flag this as cumprecheck contain preejaculate. Guidelines for calling it: If your boy is likely to have masterbated, had sex, or otherwise encouraged semen to leak out of their urethra in the last 48 hours, they probably have some fertile preejaculate. If in doubt, let it leak. The chances of pregnancy from it are low, and the MC should have been wearing protection.}
	if cumprecheck ! 1:
		!{Here it checks for vaginal deposit. If it is, it sees if theres a deposit made by someone named the same. If so, it checks if this new act is protected. If it isnt, it overwrites the old deposit.}
		if spafinloc <= 0:
			tmp_idx = arrpos('$cumarrnam',$boy)
			if tmp_idx >= 0:
				if $cumarrnam[tmp_idx] = $boy and cumarrdel[tmp_idx] = 0 and sexcontra < 3: cumarr_idx = tmp_idx
			end

			!{Next it sets the variables in the array. The cumming boys name first, sets the cum age to 0, then the cum delivery location to vaginally, then sees if its a unknowing sex act. If it is, it makes it so the MC doesnt know who did it. Then if the boy has a custom specified potency, it flags the potency. Otherwise it sets it to the default.}
			$cumarrnam[cumarr_idx] = $boy
			cumarrage[cumarr_idx] = 0
			cumarrdel[cumarr_idx] = 0
			if sexunaware > 0 and sexpartkno = 0:
				cumarrkno[cumarr_idx] = 0
			else
				cumarrkno[cumarr_idx] = 1
			end
			if sexspecpot ! 0:
				cumarrppt[cumarr_idx] = sexspecpot
			else
				cumarrppt[cumarr_idx] = 10000
			end

			!{Now it sets up the splatter and actual internal cum. First it sets the array to the spatter end of file. Then it checks for riding bareback. If theres a condom, it gives a chance for the condom to fail in general, slip off and remain in the vagina, or break.}
			sparr_idx = arrsize('sparrvol')
			tmp_idx = arrsize('sparrvol')
			:arrmodloop1
			if sparrloc[tmp_idx] = spafinloc and $sparrnam[tmp_idx] = $boy and sexcontra < 3:
				sparr_idx = tmp_idx
			else
				tmp_idx -= 1
				if tmp_idx >= 0: jump 'arrmodloop1'
			end

			if sparrppt[0] = 0 and sparr_idx = 1: sparr_idx = 0
			!{If a condom is used, determine if the condom broke or fell off}
			if sexcontra > 2:
				if sexcontra = 3 or sexcontra = 6 or sexcontra = 7:
					temprand = rand(0,1000)
					dick_wid = 3
					if $dick_girth = 'skinny': dick_wid = 2
					if $dick_girth = 'slim': dick_wid = 3
					if $dick_girth = 'well proportioned': dick_wid = 3
					if $dick_girth = 'thicker than average': dick_wid = 4
					if $dick_girth = 'thick': dick_wid = 4
					if $dick_girth = 'massive': dick_wid = 5
					if $dick_girth = 'monstrous': dick_wid = 6

					!{More likely to break with big dicks and tight pussies}
					break_thresh = dick_wid * 2
					break_thresh -= vagina / 4
					break_thresh += dick / 4

					!{More likely to slip with skinny dicks and tight pussies}
					slip_thresh = 18 - (dick_wid * 2)
					slip_thresh -= (vagina / 2)
					slip_thresh -= dick / 4

					if break_thresh < 4: break_thresh = 4
					if slip_thresh < 1: slip_thresh = 1
					!{Much more likely to break if sabotaged}
					if sexcontra = 6 or sexcontra = 7: break_thresh += 10
					break_thresh += slip_thresh

					if temprand <= slip_thresh:
						sexcontra = 5
					elseif temprand <= break_thresh:
						sexcontra = 4
					end
				end
				!{Take final value of sexcontra and apply cum potency, age, etc. as appropriate.}
				cumarrcon[cumarr_idx] = sexcontra
				if sexcontra = 3:
					cumarrcpt[cumarr_idx] += 0
				elseif sexcontra = 4:
					cumarrcpt[cumarr_idx] += cumarrppt[cumarr_idx]/2
					sparrage[sparr_idx] = 0
					sparrloc[sparr_idx] = 0
					$sparrnam[sparr_idx] = $boy
					if sexspecpot ! 0:
						sparrppt[sparr_idx] = sexspecpot
					else
						sparrppt[sparr_idx] = 10000
					end
					sparrvol[sparr_idx] += sexvolume
					cumsumbod += sexvolume
					cumsumvag += sexvolume
					if sexvolume <= 0: sparrvol[sparr_idx] += 40 & cumsumbod += 40 & cumsumvag += 40
					sparridt[sparr_idx] = sexpartkno
					sparrslc[sparr_idx] = 0
				elseif sexcontra = 5:
					cumarrcpt[cumarr_idx] += cumarrppt[cumarr_idx]/20
					cumcondslip = 1
					cumcondsanb = cumarr_idx
					sparrage[sparr_idx] = 0
					sparrloc[sparr_idx] = 17
					$sparrnam[sparr_idx] = $boy
					if sexspecpot ! 0:
						sparrppt[sparr_idx] = sexspecpot
					else
						sparrppt[sparr_idx] = 10000
					end
					sparrvol[sparr_idx] += sexvolume
					cumsumbod += sexvolume
					cumsumvag += sexvolume
					if sexvolume <= 0: sparrvol[sparr_idx] += 40 & cumsumbod += 40 & cumsumvag += 40
					sparridt[sparr_idx] = sexpartkno
					sparrslc[sparr_idx] = 0
					!{!Next it checks for sabotaged condoms. First sabotaged by you, then sabotaged by the guy. If they were sabotaged, it acts similar to a condom failure, but worse.}
				elseif sexcontra = 6 or sexcontra = 7:
					cumarrcpt[cumarr_idx] += cumarrppt[cumarr_idx]/3
				end
				!{If you have no protection, you get a nice full load of semen.}
			else
				sparrage[sparr_idx] = 0
				sparrloc[sparr_idx] = 0
				$sparrnam[sparr_idx] = $boy
				if sexspecpot ! 0:
					sparrppt[sparr_idx] = sexspecpot
				else
					sparrppt[sparr_idx] = 10000
				end
				sparrvol[sparr_idx] += sexvolume
				cumsumbod += sexvolume
				cumsumvag += sexvolume
				if sexvolume <= 0: sparrvol[sparr_idx] += 40 & cumsumbod += 40 & cumsumvag += 40
				sparridt[sparr_idx] = sexpartkno
				sparrslc[sparr_idx] = 0
				cumarrcpt[cumarr_idx] += cumarrppt[cumarr_idx]/5*4
				cumarrcon[cumarr_idx] = sexcontra
			end
			!{If you arent getting it in the vagina, and the boy isnt pumping it into a condom, a spatter is made and applied. If you arent wearing any panties and it was called to hit your panties, it goes directly to your groin. If you are naked and it calls for a clothing strike, it will go to your body instead.}
		elseif spafinloc > 0 and sexcontra < 3:
			sparr_idx = arrsize('sparrvol')
			tmp_idx = arrsize('sparrvol')
			:arrmodloop2
			if sparrloc[tmp_idx] = spafinloc and $sparrnam[tmp_idx] = $boy and sexcontra < 3:
			sparr_idx = tmp_idx
			else
			tmp_idx -= 1
			if tmp_idx >= 0: jump 'arrmodloop2'
			end
			sparrage[sparr_idx] = 0
			if tanga = 0:
				if spafinloc = 2:
					spafinloc = 1
				elseif spafinloc = 5: 
					spafinloc = 4
				end
			end
			if $clothingworntype = 'nude':
				if spafinloc = 2:
					spafinloc = 1
				elseif spafinloc = 5:
					spafinloc = 4
				elseif spafinloc = 6:
					if rand(0,1) = 0:
						spafinloc = 1
					else
						spafinloc = 4
					end
				elseif spafinloc = 7:
					if rand(0,1) = 0:
						spafinloc = 14
					else
						spafinloc = 15
					end
				end
			end
			sparrloc[sparr_idx] = spafinloc
			if spafinloc = 12 and swallow >= 10 and rand(0,3) = 0: energy += 2
			$sparrnam[sparr_idx] = $boy
			if sexspecpot ! 0:
				sparrppt[sparr_idx] = sexspecpot
			else
				sparrppt[sparr_idx] = 10000
			end
			sparrvol[sparr_idx] += sexvolume
			cumsumbod += sexvolume
			if sexvolume <= 0: sparrvol[sparr_idx] += 40 & cumsumbod += 40 & cumsumvag += 40
			if spafinloc = 3:
				cumsumass += sexvolume
				if sexvolume <= 0: cumsumass += 40
			end
			sparridt[sparr_idx] = sexpartkno
			sparrslc[sparr_idx] = 0
		end
		sexpartkno = 0
		sexunaware = 0
		sexspecpot = 0
	elseif (sexcontra < 3 or sexcontra > 5) and spafinloc = 0:
		!{And this is the pre ejaculate release talked about above.}
		tmp_idx = arrpos('$cumarrnam',$boy)
		if tmp_idx ! -1 and cumarrdel[tmp_idx] = 0: cumarr_idx = tmp_idx
		$cumarrnam[cumarr_idx] = $boy
		cumarrage[cumarr_idx] = 0
		cumarrdel[cumarr_idx] = 0
		cumarrkno[cumarr_idx] = 0
		if sexspecpot ! 0:
			cumarrppt[cumarr_idx] = sexspecpot
		else
			cumarrppt[cumarr_idx] = 10000
		end
		cumarrcon[cumarr_idx] = sexcontra
		cumarrcpt[cumarr_idx] = cumarrppt[cumarr_idx]/12
	end

	sexspecpot = 0
	cumprecheck = 0
	spafinloc = 0
	sexvolume = 0
	tmp_idx = 0
	dynamic $din_Update_Condom_Counts
	if cumsumass >= 60:
		tmp_idx = arrpos('sparrloc',3)
		if sparrslc[tmp_idx] <= 0: sparrslc[tmp_idx] += 1
	end
	if cumsumvag >= 60:
		tmp_idx = arrpos('sparrloc',0)
		if sparrslc[tmp_idx] <= 0: sparrslc[tmp_idx] += 1
	end
end



if $ARGS[0] = 'cumeater1':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your stomach in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your stomach with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:temp = 14 & gs 'cum_cleanup', 'cumeatercleanup'
end
if $ARGS[0] = 'cumeater2':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your pussy in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your pussy with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:
		temp = 0 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 1 & gs 'cum_cleanup', 'cumeatercleanup'
	end
end
if $ARGS[0] = 'cumeater3':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your buttocks in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your buttocks with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:temp = 4 & gs 'cum_cleanup', 'cumeatercleanup'
end
if $ARGS[0] = 'cumeater4':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your face in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your face with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:temp = 11 & gs 'cum_cleanup', 'cumeatercleanup'
end
if $ARGS[0] = 'cumeater5':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your clothes in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your clothes with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:
		temp = 2 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 5 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 6 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 7 & gs 'cum_cleanup', 'cumeatercleanup'
	end
end
if $ARGS[0] = 'cumeater6':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your anus in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your anus with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:temp = 3 & gs 'cum_cleanup', 'cumeatercleanup'
end
if $ARGS[0] = 'cumeater7':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your body in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your body with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:
		temp = 8 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 9 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 10 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 11 & gs 'cum_cleanup', 'cumeatercleanup'
		temp = 15 & gs 'cum_cleanup', 'cumeatercleanup'
	end
end
if $ARGS[0] = 'cumeater8':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 100:
		sparrvol[temp1arr] = 0
		gs 'stat'
		'You lick up the whole mouthful of sperm, feeling the tart taste as you eat it.'
	else
		sparrvol[temp1arr] = 0
		gs 'stat'
		'You lick your fingers clean, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:temp = 13 & gs 'cum_cleanup', 'cumeatercleanup'
end
if $ARGS[0] = 'cumeater9':
	spdirtyb = 1
	fbreath = 0
	vaf += 1
	if sparrvol[temp1arr] > 150:
		sparrvol[temp1arr] -= 100
		gs 'stat'
		'You collect a handful of sperm from your hair in your hand and lick it all up, feeling the tart taste of semen.'
	else
		sparrvol[temp1arr] -= 20
		gs 'stat'
		'You collect the sperm from your hair with your fingers and lick them, feeling the tart taste of semen.'
	end
	if sparrvol[temp1arr] <= 0:temp = 16 & gs 'cum_cleanup', 'cumeatercleanup'
end

--- Cum_Manage ---------------------------------

